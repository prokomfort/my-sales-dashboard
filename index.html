<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Executive Sales Dashboard</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;700&display=swap');
        
        html, body { height: 100%; overflow: hidden; zoom: 0.95; }
        body { font-family: 'Inter', sans-serif; background-color: #0f1115; color: #e2e8f0; margin: 0; display: flex; align-items: center; justify-content: center; padding: 1rem; }
        .max-w-custom { width: 95vw; aspect-ratio: 5 / 4; max-height: 95vh; display: flex; flex-direction: column; gap: 1.25rem; }
        .glass-card { background: rgba(30, 35, 45, 0.7); border: 1px solid rgba(255, 255, 255, 0.05); backdrop-filter: blur(10px); border-radius: 20px; }
        .progress-ring { transition: stroke-dashoffset 0.35s; transform: rotate(-90deg); transform-origin: 50% 50%; }
        .stat-value { background: linear-gradient(180deg, #fff 0%, #94a3b8 100%); -webkit-background-clip: text; -webkit-text-fill-color: transparent; }
        .glow-ring { filter: drop-shadow(0 0 8px rgba(52, 211, 153, 0.6)); }
        .glow-orange { filter: drop-shadow(0 0 7px rgba(249, 115, 22, 0.8)); }
        .vacation-badge { background-color: #2a1f1a; border: 1px solid #7c4a2a; border-radius: 16px; padding: 12px; display: flex; flex-direction: column; align-items: center; justify-content: center; width: 140px; height: 110px; }
        .chart-container { position: relative; width: 100%; height: 350px; display: flex; align-items: center; justify-content: center; }
        .sector-path { transition: all 0.5s ease-out; cursor: pointer; }
        .calendar-grid { display: grid; grid-template-columns: repeat(7, 1fr); gap: 4px; }
        .calendar-day { font-size: 14px; padding: 4px; text-align: center; border-radius: 6px; }
        .today { background: #3b82f6; color: white; font-weight: bold; }
        .weekend { color: #ff3b5c; font-weight: 600; } 
        .table-container { flex: 1; overflow-y: hidden; }
        .table-header-text { font-size: 14px; } 
        .table-body-text { font-size: 18px; }      
        .table-cell-padding { padding: 0.75rem 1.25rem; } 
        .manager-name-text { font-size: 16px; }       
        .manager-fact-text { font-size: 28px; }       
        .manager-percent-center { font-size: 24px; }  
    </style>
</head>
<body>

    <div class="max-w-custom mx-auto">
        <!-- ВЕРХНЯЯ ПАНЕЛЬ -->
        <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
            <div class="glass-card p-6 flex flex-col justify-between">
                <span class="text-slate-400 text-sm font-medium uppercase tracking-wider">План командный</span>
                <div class="flex items-end justify-between">
                    <h2 class="text-7xl font-bold stat-value" id="header-total-plan">0M</h2>
                    <span class="text-slate-500 mb-2 text-base">RUB</span>
                </div>
            </div>

            <div class="glass-card p-6 flex flex-col justify-between border-b-4 border-emerald-500/30">
                <div class="flex justify-between items-start">
                    <span class="text-slate-400 text-sm font-medium uppercase tracking-wider">Прогресс выполнения</span>
                    <div class="text-4xl font-bold text-emerald-400" id="header-total-percent">0%</div>
                </div>
                <div class="space-y-2 mt-4">
                    <div class="w-full bg-slate-800 h-3 rounded-full overflow-hidden">
                        <div id="header-progress-bar" class="h-full bg-gradient-to-r from-emerald-600 to-emerald-400 rounded-full transition-all duration-1000" style="width: 0%"></div>
                    </div>
                    <div class="flex justify-between items-end">
                         <h2 class="text-3xl font-bold text-white" id="header-total-fact">0M</h2>
                         <span class="text-[14px] text-slate-500 pb-0.5 uppercase italic">цель: <span id="header-plan-label">0</span></span>
                    </div>
                </div>
            </div>

            <div class="glass-card p-5 flex flex-row items-center justify-between gap-6">
                <div class="flex flex-col justify-between h-full py-1 pl-4 shrink-0">
                    <span class="text-slate-400 text-[11px] font-medium uppercase tracking-wider">Календарь</span>
                    <div class="mt-2 space-y-3">
                        <div class="leading-none">
                            <div class="text-4xl font-bold text-white" id="days-total">0</div>
                            <span class="text-[11px] uppercase font-medium text-slate-300 tracking-tighter">раб. дней</span>
                        </div>
                        <div class="leading-none">
                            <div class="text-4xl font-bold text-orange-400" id="days-left">0</div>
                            <span class="text-[11px] uppercase font-medium text-slate-300 tracking-tighter">осталось</span>
                        </div>
                    </div>
                </div>
                <div class="flex-grow ml-4">
                    <div id="current-month" class="text-[14px] font-bold text-sky-400 uppercase tracking-widest text-center mb-2">МЕСЯЦ</div>
                    <div class="text-[11px] text-slate-500 mb-2 flex justify-between uppercase font-bold px-1">
                        <span>Пн</span><span>Вт</span><span>Ср</span><span>Чт</span><span>Пт</span><span class="text-[#ff3b5c]">Сб</span><span class="text-[#ff3b5c]">Вс</span>
                    </div>
                    <div id="calendar-body" class="calendar-grid"></div>
                </div>
            </div>
        </div>

        <!-- Сетка сотрудников (8 человек) -->
        <div id="managers-grid" class="grid grid-cols-4 md:grid-cols-8 gap-3"></div>

        <div class="grid grid-cols-1 lg:grid-cols-3 gap-6 h-full min-h-0">
            <div class="lg:col-span-2 glass-card overflow-hidden flex flex-col">
                <div class="px-6 py-4 border-b border-white/5 bg-white/5 flex justify-between items-center">
                    <h3 class="font-semibold text-xl text-white">Детализация по сотрудникам</h3>
                    <span class="text-emerald-500 uppercase tracking-widest bg-emerald-500/10 px-4 py-1.5 rounded text-xs">Рейтинг по факту продаж</span>
                </div>
                <div class="table-container">
                    <table class="w-full text-left border-collapse">
                        <thead>
                            <tr class="text-slate-300 table-header-text uppercase tracking-wider border-b border-white/5 bg-white/[0.02]">
                                <th class="table-cell-padding font-medium text-center w-12">#</th>
                                <th class="table-cell-padding font-medium">Менеджер</th>
                                <th class="table-cell-padding font-medium text-right">План мес.</th>
                                <th class="table-cell-padding font-medium text-right">План день</th>
                                <th class="table-cell-padding font-medium text-right">Факт день</th>
                                <th class="table-cell-padding font-medium text-right">Факт мес.</th>
                                <th class="table-cell-padding font-medium text-right">Остаток/Сверх</th>
                            </tr>
                        </thead>
                        <tbody id="table-body" class="table-body-text"></tbody>
                    </table>
                </div>
            </div>
            <div class="glass-card p-6 flex flex-col justify-center">
                <h3 class="font-semibold text-lg mb-4 text-center text-white">Доля в результате</h3>
                <div id="radial-chart-box" class="chart-container"></div>
            </div>
        </div>
    </div>

    <script>
        /**
         * БЛОК ДАННЫХ ДЛЯ РЕДАКТИРОВАНИЯ
         * Просто меняйте значения ниже в кавычках и цифрах
         */
        const CONFIG = {
            teamPlan: 15000000, // Общий план команды
            totalWorkingDays: 22, // Всего рабочих дней в месяце
            daysRemaining: 10,    // Осталось рабочих дней
            
            managers: [
                { name: "Иван Иванов", plan: 2500000, fact: 1800000, vacation: false },
                { name: "Анна Смирнова", plan: 2500000, fact: 2650000, vacation: false },
                { name: "Петр Петров", plan: 2000000, fact: 500000, vacation: true },
                { name: "Елена Кузнецова", plan: 2000000, fact: 1950000, vacation: false },
                { name: "Максим Орлов", plan: 1500000, fact: 1200000, vacation: false },
                { name: "Ольга Соколова", plan: 1500000, fact: 800000, vacation: false },
                { name: "Дмитрий Волков", plan: 1500000, fact: 1450000, vacation: false },
                { name: "Марина Морозова", plan: 1500000, fact: 1100000, vacation: false }
            ]
        };

        const RADIAL_PALETTE = ['#06b6d4', '#10b981', '#0891b2', '#14b8a6', '#0ea5e9', '#4f46e5', '#8b5cf6', '#ec4899'];

        function initCalendar() {
            const now = new Date();
            const monthNames = ["Январь", "Февраль", "Март", "Апрель", "Май", "Июнь", "Июль", "Август", "Сентябрь", "Октябрь", "Ноябрь", "Декабрь"];
            const monthHeader = document.getElementById('current-month');
            if (monthHeader) monthHeader.innerText = monthNames[now.getMonth()];
            
            const firstDay = new Date(now.getFullYear(), now.getMonth(), 1).getDay();
            const startOffset = firstDay === 0 ? 6 : firstDay - 1;
            const daysInMonth = new Date(now.getFullYear(), now.getMonth() + 1, 0).getDate();
            const calendarBody = document.getElementById('calendar-body');
            
            if (calendarBody) {
                calendarBody.innerHTML = '';
                for (let i = 0; i < startOffset; i++) calendarBody.appendChild(document.createElement('div'));
                for (let d = 1; d <= daysInMonth; d++) {
                    const dayEl = document.createElement('div');
                    dayEl.innerText = d;
                    const dw = new Date(now.getFullYear(), now.getMonth(), d).getDay();
                    dayEl.className = `calendar-day ${d === now.getDate() ? 'today' : ''} ${dw === 0 || dw === 6 ? 'weekend' : ''}`;
                    calendarBody.appendChild(dayEl);
                }
            }
        }

        function renderRadialChart() {
            const container = document.getElementById('radial-chart-box');
            if (!container) return;
            
            const sorted = [...CONFIG.managers].sort((a,b) => b.fact - a.fact);
            const totalFact = sorted.reduce((acc, m) => acc + m.fact, 0);
            const size = 340; const center = size / 2;
            const innerRadius = 45; const maxRadius = 160;
            
            let svgHtml = `<svg width="${size}" height="${size}" viewBox="0 0 ${size} ${size}" style="overflow: visible;">`;
            let currentAngle = -Math.PI / 2;
            
            sorted.forEach((m, i) => {
                if (totalFact === 0) return;
                const share = m.fact / totalFact;
                const angleSpan = share * Math.PI * 2;
                const midAngle = currentAngle + angleSpan / 2;
                const currentRadius = innerRadius + (maxRadius - innerRadius) * (m.fact / (sorted[0].fact || 1));
                const color = RADIAL_PALETTE[i % RADIAL_PALETTE.length];
                
                const x1 = center + innerRadius * Math.cos(currentAngle);
                const y1 = center + innerRadius * Math.sin(currentAngle);
                const x2 = center + currentRadius * Math.cos(currentAngle);
                const y2 = center + currentRadius * Math.sin(currentAngle);
                const x3 = center + currentRadius * Math.cos(currentAngle + angleSpan);
                const y3 = center + currentRadius * Math.sin(currentAngle + angleSpan);
                const x4 = center + innerRadius * Math.cos(currentAngle + angleSpan);
                const y4 = center + innerRadius * Math.sin(currentAngle + angleSpan);
                const largeArc = angleSpan > Math.PI ? 1 : 0;
                
                svgHtml += `<path d="M ${x1} ${y1} L ${x2} ${y2} A ${currentRadius} ${currentRadius} 0 ${largeArc} 1 ${x3} ${y3} L ${x4} ${y4} A ${innerRadius} ${innerRadius} 0 ${largeArc} 0 ${x1} ${y1}" fill="${color}" opacity="0.9" stroke="#0f1115" class="sector-path"></path>`;
                
                if (share > 0.04) {
                   const labelRadius = innerRadius + (currentRadius - innerRadius) * 0.6;
                   const tx = center + labelRadius * Math.cos(midAngle);
                   const ty = center + labelRadius * Math.sin(midAngle);
                   let rot = (midAngle * 180 / Math.PI) + 90;
                   if (rot > 90 && rot < 270) rot += 180;
                   svgHtml += `<g transform="translate(${tx}, ${ty}) rotate(${rot})"><text text-anchor="middle" y="3" style="font-size: 9px; fill: white; font-weight: bold; text-transform: uppercase;">${m.name.split(' ')[0]}</text></g>`;
                }
                currentAngle += angleSpan;
            });
            svgHtml += `<circle cx="${center}" cy="${center}" r="${innerRadius-10}" fill="#161b22" /></svg>`;
            container.innerHTML = svgHtml;
        }

        function updateUI() {
            initCalendar();
            const totalFactTeam = CONFIG.managers.reduce((acc, m) => acc + m.fact, 0);
            const passedDays = Math.max(1, CONFIG.totalWorkingDays - CONFIG.daysRemaining);
            const teamPlanAchieved = totalFactTeam >= CONFIG.teamPlan;

            const grid = document.getElementById('managers-grid');
            if (grid) {
                grid.innerHTML = '';
                CONFIG.managers.forEach(m => {
                    const percent = m.plan > 0 ? Math.round((m.fact / m.plan) * 100) : 0;
                    let commissionRate = 8, commissionColor = "text-slate-300", ringGlow = "text-sky-500", ringStroke = "currentColor";
                    if (!m.vacation) {
                        if (percent >= 150 && teamPlanAchieved) { 
                            commissionRate = 11; commissionColor = "text-orange-500 font-bold"; ringGlow = "text-orange-500 glow-orange"; ringStroke = "#f97316"; 
                        } else if (percent >= 100) { 
                            commissionRate = 10; commissionColor = "text-emerald-400 font-bold"; ringGlow = "text-emerald-400 glow-ring"; 
                        } else { 
                            commissionRate = 8; commissionColor = "text-sky-400"; 
                        }
                    }
                    const card = document.createElement('div');
                    card.className = 'glass-card p-3 py-4 flex flex-col items-center text-center';
                    card.innerHTML = m.vacation ? `
                        <div class="vacation-badge mb-3"><span class="text-[#7c4a2a] text-[10px] font-bold uppercase">Статус</span><span class="text-[#d97706] text-xl font-black uppercase leading-tight">Отпуск</span><span class="text-[#d97706] text-2xl font-black mt-1">8%</span></div>
                        <div class="manager-name-text font-bold text-slate-300 uppercase truncate w-full">${m.name.split(' ')[0]}</div><div class="manager-fact-text font-black text-white leading-none">${(m.fact / 1000).toFixed(0)}к</div>
                    ` : `
                        <div class="relative mb-3 flex items-center justify-center"><svg width="100" height="100"><circle class="text-slate-800" stroke-width="7" stroke="currentColor" fill="transparent" r="44" cx="50" cy="50"/><circle class="progress-ring ${ringGlow}" stroke-width="7" stroke-dasharray="276" stroke-dashoffset="${276 - (Math.min(percent, 100)/100)*276}" stroke-linecap="round" stroke="${ringStroke}" fill="transparent" r="44" cx="50" cy="50"/></svg><span class="absolute manager-percent-center font-extrabold text-white">${percent}%</span></div>
                        <div class="manager-name-text font-bold text-slate-300 uppercase truncate w-full">${m.name.split(' ')[0]}</div><div class="manager-fact-text font-black text-white leading-none">${(m.fact / 1000).toFixed(0)}к</div>
                        <div class="mt-2 px-2 py-0.5 rounded-full bg-white/5 border border-white/10 text-[10px]"><span class="${commissionColor}">${commissionRate}%</span></div>
                    `;
                    grid.appendChild(card);
                });
            }

            const tableBody = document.getElementById('table-body');
            if (tableBody) {
                tableBody.innerHTML = '';
                let displayIndex = 1;
                [...CONFIG.managers].sort((a,b) => b.fact-a.fact).forEach((m) => {
                    const percent = m.plan > 0 ? Math.round((m.fact / m.plan) * 100) : 0;
                    const rem = m.plan - m.fact;
                    const pd = Math.round(m.plan / (CONFIG.totalWorkingDays || 1));
                    const fd = Math.round(m.fact / passedDays);
                    const row = document.createElement('tr');
                    row.className = `border-b border-white/5 hover:bg-white/5 transition-colors`;
                    row.innerHTML = `<td class="table-cell-padding text-center font-mono text-slate-500 text-sm">${displayIndex++}</td><td class="table-cell-padding font-semibold text-slate-100">${m.name}</td><td class="table-cell-padding text-right text-slate-300 font-mono">${m.plan.toLocaleString()}</td><td class="table-cell-padding text-right text-slate-400 font-mono text-sm">${pd.toLocaleString()}</td><td class="table-cell-padding text-right ${fd < pd ? 'text-sky-400' : 'text-emerald-400'} font-bold">${fd.toLocaleString()}</td><td class="table-cell-padding text-right"><div class="font-bold ${percent >= 100 ? 'text-emerald-400' : 'text-white'}">${m.fact.toLocaleString()}</div><div class="w-full h-1 bg-slate-800 rounded-full mt-1.5 overflow-hidden"><div class="h-full bg-emerald-500" style="width: ${Math.min(percent, 100)}%"></div></div></td><td class="table-cell-padding text-right font-mono text-sm">${rem <= 0 ? `<div class="text-emerald-400 font-bold">ВЫПОЛНЕНО</div>` : `<span class="text-slate-300">${rem.toLocaleString()}</span>`}</td>`;
                    tableBody.appendChild(row);
                });
            }

            const totalPercent = CONFIG.teamPlan > 0 ? Math.round((totalFactTeam / CONFIG.teamPlan) * 100) : 0;
            document.getElementById('header-total-plan').innerText = (CONFIG.teamPlan / 1000000).toFixed(1) + 'M';
            document.getElementById('header-total-fact').innerText = (totalFactTeam / 1000000).toFixed(1) + 'M';
            document.getElementById('header-total-percent').innerText = totalPercent + '%';
            document.getElementById('header-plan-label').innerText = (CONFIG.teamPlan / 1000000).toFixed(1) + 'M';
            document.getElementById('header-progress-bar').style.width = Math.min(totalPercent, 100) + '%';
            document.getElementById('days-total').innerText = CONFIG.totalWorkingDays;
            document.getElementById('days-left').innerText = CONFIG.daysRemaining;
            renderRadialChart();
        }

        window.onload = updateUI;
    </script>
</body>
</html>
